<ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-back-button class="mobile-only" text=""></ion-back-button>
        <ion-menu-button></ion-menu-button>
      </ion-buttons>
      <ion-buttons slot="end">
          <ion-button fill="outline" (click)="getStaticMap()" *ngIf="gmap">
            <ion-icon name="cloud-download" slot="icon-only"></ion-icon>
          </ion-button>
          <ion-button fill="outline" [href]="'/home/'+parent?.uuid">
            <ion-icon name="create" slot="icon-only"></ion-icon>
          </ion-button>
      </ion-buttons>    
      <ion-title>
        {{parent?.label || parent?.seq}}
      </ion-title>
    </ion-toolbar>
  </ion-header>
  
  <ion-header class="google-maps-wrap">
    <!-- googleMaps -->
    <app-google-maps #gmap *ngIf="markerCollection$ | async as items"
    apiKey="AIzaSyApvJzra_C7sKYF8q1InQWw5c7RfTYTg94" 
    [items]="items"
    [mode]="mapSettings"
    [(selected)]="selectedMarkerGroup"
    (mapReady)="setMap($event)"
    ></app-google-maps>
  </ion-header>
  
  
  <ion-content no-padding class="marker-group-wrap content-right-if-mq-landscape">
  
 

    <!-- groupItem -->
    <ng-container [ngSwitch]="layout">

      <ion-grid no-padding *ngSwitchCase="'default'">
        <ion-row>
          <ion-col size="12" size-sm="6" size-xl="4">
               <!-- QRcode/Share Map ion-card -->
                  <ion-card class="qrcode" *ngIf="qrcodeData">
                    <ion-card-header>
                        <ion-toolbar color="primary">
                            <ion-card-title color="light" >Share Map</ion-card-title>
                            <ion-buttons slot="end">
                              <ion-button color="light" fill="outline" title="Share QR Code"
                                (click)="toggle.mapLink=!toggle.mapLink">
                                <ion-icon slot="icon-only" name="share"></ion-icon>
                              </ion-button>    
                              <ion-button color="light" fill="outline" title="Show Printable Map"
                                (click)="browserOpen(qrcodeData)">
                                  <ion-icon slot="icon-only" name="open"></ion-icon>
                              </ion-button>         
                              <ion-button color="light" fill="outline" 
                                (click)="qrcodeData=null">
                                <ion-icon slot="icon-only" name="close"></ion-icon>
                              </ion-button>
                            </ion-buttons>
                          </ion-toolbar>        
                    </ion-card-header>
                    <ion-card-content padding-vertical>
                      <ion-item text-center no-padding>
                        <ion-label>
                          <p>Scan this QR code to link to this page.</p>
                        </ion-label>          
                      </ion-item>
                      <ion-item no-padding>
                        <div [ngStyle]="{'margin':'auto'}">
                            <qrcode [qrdata]="qrcodeData" [size]="256" [level]="'M'"></qrcode>
                        </div>
                      </ion-item>
                      <ion-item no-padding>
                        <ion-label *ngIf="toggle.mapLink">
                          <h2>Copy Map Link</h2>
                          <p><ion-text text-wrap color="primary">{{qrcodeData}}</ion-text></p>
                        </ion-label>
                      </ion-item>  
                    </ion-card-content>
                  </ion-card>
          </ion-col>
        </ion-row>        
        <ion-row>
          <ion-col size="12" size-sm="6" size-xl="4"
            class="marker-group-focus"
            ngClass.centered="mgFocus"
            *ngFor="let item of mgCollection$ | async">
            <app-marker-group  *ngIf="item?._rest_action!='delete'"
              [mg]="item" [parentLayout]="'share'"
              (mgChange)="childComponentsChange($event)"
              (thumbClick)="openGallery($event)"
              [(mgFocus)]="mgFocus" ></app-marker-group>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size="12" size-sm="6" size-xl="4">
            <app-photoswipe class="content-right-if-mq-landscape" [data]="gallery"
              (indexChange)="focusMarker($event)"
            ></app-photoswipe>
          </ion-col>
        </ion-row>
      </ion-grid>

    </ng-container>
  
    
  
  </ion-content>
  